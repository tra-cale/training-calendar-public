<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç®¡ç†ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ 2025</title>
<style>
* { 
  margin: 0; 
  padding: 0; 
  box-sizing: border-box; 
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #FFF9C4 0%, #FFECB3 50%, #FFE082 100%);
  min-height: 100vh;
  padding: 20px;
  color: #212121;
}

.container {
  max-width: 800px;
  margin: 0 auto;
}

/* ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
.hero-section {
  text-align: center;
  padding: 60px 20px;
  margin-bottom: 40px;
}

.hero-icon {
  font-size: 80px;
  margin-bottom: 20px;
  animation: float 3s ease-in-out infinite;
}

@keyframes float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.hero-title {
  font-size: 2.5em;
  font-weight: bold;
  background: linear-gradient(135deg, #F57C00 0%, #FFB300 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 10px;
}

.hero-subtitle {
  font-size: 1.2em;
  color: #616161;
  margin-bottom: 30px;
}

.hero-cta {
  display: inline-block;
  padding: 16px 48px;
  background: linear-gradient(135deg, #F57C00, #FFB300);
  color: white;
  font-size: 1.2em;
  font-weight: 600;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(245, 124, 0, 0.3);
}

.hero-cta:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(245, 124, 0, 0.4);
}

/* ã‚«ãƒ¼ãƒ‰å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
.card {
  background: white;
  border-radius: 16px;
  padding: 32px;
  margin-bottom: 30px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
}

.card-title {
  font-size: 1.5em;
  font-weight: 600;
  color: #212121;
  margin-bottom: 20px;
  display: flex;
  align-items: center;
  gap: 10px;
}

/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šã‚«ãƒ¼ãƒ‰ */
.profile-setup-card {
  background: linear-gradient(145deg, #FFFFFF, #FFFBF5);
}

.setup-header {
  text-align: center;
  margin-bottom: 30px;
}

.setup-title {
  font-size: 1.8em;
  font-weight: 600;
  color: #212121;
  margin-bottom: 10px;
}

.setup-subtitle {
  color: #616161;
  font-size: 1em;
}

.form-group {
  margin-bottom: 24px;
  text-align: center;
}

.form-label {
  display: block;
  font-size: 0.95em;
  font-weight: 600;
  color: #424242;
  margin-bottom: 8px;
  text-align: center;
}

.form-hint {
  font-size: 0.85em;
  color: #9E9E9E;
  margin-top: 4px;
  text-align: center;
}

.form-input {
  width: 100%;
  padding: 12px 16px;
  font-size: 1em;
  border: 2px solid #E0E0E0;
  border-radius: 8px;
  transition: all 0.3s ease;
}

.form-input:focus {
  outline: none;
  border-color: #FFB300;
  box-shadow: 0 0 0 3px rgba(255, 179, 0, 0.1);
}

.form-input.error {
  border-color: #EF5350;
}

.error-message {
  color: #EF5350;
  font-size: 0.85em;
  margin-top: 4px;
  display: none;
  text-align: center;
}

.error-message.show {
  display: block;
}

/* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ */
.radio-group {
  display: inline-flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: center;
}

.radio-group.vertical {
  flex-direction: column;
  align-items: flex-start;
}

.radio-option {
  display: flex;
  align-items: center;
  cursor: pointer;
}

.radio-option input[type="radio"] {
  width: 20px;
  height: 20px;
  margin-right: 8px;
  cursor: pointer;
  accent-color: #F57C00;
}

.radio-option label {
  font-size: 0.95em;
  cursor: pointer;
  user-select: none;
}

/* æ•°å€¤å…¥åŠ›ã‚°ãƒ«ãƒ¼ãƒ— */
.input-with-unit {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  max-width: 200px;
  margin: 0 auto;
}

.input-with-unit .form-input {
  flex: 1;
  text-align: center;
}

.unit {
  font-size: 0.95em;
  color: #616161;
  font-weight: 500;
}

/* ãƒœã‚¿ãƒ³ */
.btn {
  padding: 14px 32px;
  font-size: 1.1em;
  font-weight: 600;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
  display: inline-block;
  text-decoration: none;
}

.btn-primary {
  background: linear-gradient(135deg, #F57C00, #FFB300);
  color: white;
  width: 100%;
  box-shadow: 0 4px 12px rgba(245, 124, 0, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(245, 124, 0, 0.4);
}

.btn-primary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}

.skip-link {
  display: block;
  text-align: center;
  margin-top: 16px;
  color: #9E9E9E;
  text-decoration: none;
  font-size: 0.95em;
  transition: color 0.3s ease;
}

.skip-link:hover {
  color: #616161;
}

/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤ºã‚«ãƒ¼ãƒ‰ */
.profile-display-card {
  background: linear-gradient(145deg, #FFF9C4, #FFFFFF);
  border: 2px solid #FFD54F;
}

/* æœˆé–“ç›®æ¨™è¡¨ç¤ºã‚«ãƒ¼ãƒ‰ */
.goal-display-card {
  background: linear-gradient(145deg, #E8F5E9, #FFFFFF);
  border: 3px solid #66BB6A;
  box-shadow: 0 4px 15px rgba(102, 187, 106, 0.2);
}

.goal-display-header {
  text-align: center;
  margin-bottom: 24px;
}

.goal-display-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

.goal-display-item {
  display: flex;
  flex-direction: column;
  background: white;
  padding: 12px;
  border-radius: 10px;
  border: 1px solid #E0E0E0;
}

.goal-display-label {
  font-size: 0.85em;
  color: #616161;
  margin-bottom: 4px;
}

.goal-display-value {
  font-size: 1.1em;
  font-weight: 600;
  color: #2E7D32;
}

.profile-header {
  text-align: center;
  margin-bottom: 24px;
}

.profile-name {
  font-size: 1.5em;
  font-weight: 600;
  color: #212121;
  margin-bottom: 8px;
}

.profile-info-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
  margin-bottom: 24px;
}

.profile-info-item {
  display: flex;
  flex-direction: column;
}

.profile-info-label {
  font-size: 0.85em;
  color: #616161;
  margin-bottom: 4px;
}

.profile-info-value {
  font-size: 1.1em;
  font-weight: 600;
  color: #212121;
}

.bmi-low {
  color: #42A5F5;
}

.bmi-normal {
  color: #66BB6A;
}

.bmi-high {
  color: #FFA726;
}

.bmi-very-high {
  color: #EF5350;
}

.btn-edit {
  background: white;
  color: #F57C00;
  border: 2px solid #F57C00;
  width: 100%;
}

.btn-edit:hover {
  background: #F57C00;
  color: white;
}

/* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚«ãƒ¼ãƒ‰ */
.nav-card {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: white;
  border-radius: 16px;
  padding: 24px;
  margin-bottom: 20px;
  text-decoration: none;
  color: inherit;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.nav-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  border-color: #FFD54F;
}

.nav-card-content {
  display: flex;
  align-items: center;
  gap: 20px;
}

.nav-card-icon {
  font-size: 2.5em;
}

.nav-card-text {
  display: flex;
  flex-direction: column;
}

.nav-card-title {
  font-size: 1.2em;
  font-weight: 600;
  color: #212121;
  margin-bottom: 4px;
}

.nav-card-subtitle {
  font-size: 0.9em;
  color: #616161;
}

.nav-card-arrow {
  font-size: 1.5em;
  color: #FFB300;
  font-weight: bold;
}

/* ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ */
.hidden {
  display: none;
}

.fade-in {
  animation: fadeIn 0.5s ease-in;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
@media (max-width: 768px) {
  .hero-title {
    font-size: 2em;
  }

  .hero-subtitle {
    font-size: 1em;
  }

  .profile-info-grid {
    grid-template-columns: 1fr;
  }

  .goal-display-grid {
    grid-template-columns: 1fr;
  }

  .goal-method-cards {
    grid-template-columns: 1fr;
  }

  .goal-method-card {
    padding: 30px 20px;
  }

  .goal-method-icon {
    font-size: 3em;
  }

  .nav-card-content {
    gap: 15px;
  }

  .nav-card-icon {
    font-size: 2em;
  }

  .nav-card-title {
    font-size: 1em;
  }

  .nav-card-subtitle {
    font-size: 0.85em;
  }
}

/* æœˆé–“ç›®æ¨™è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« */
.goal-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.5);
  z-index: 2000;
  align-items: center;
  justify-content: center;
  padding: 20px;
  overflow-y: auto;
}

.goal-modal.active {
  display: flex;
}

.goal-modal-content {
  background: white;
  border-radius: 20px;
  max-width: 600px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

.goal-modal-header {
  background: linear-gradient(135deg, #66BB6A, #43A047);
  color: white;
  padding: 20px 30px;
  border-radius: 20px 20px 0 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.goal-modal-header h2 {
  font-size: 1.5em;
  margin: 0;
}

.goal-close-btn {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  font-size: 1.5em;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  cursor: pointer;
  transition: all 0.3s;
}

.goal-close-btn:hover {
  background: rgba(255,255,255,0.3);
  transform: rotate(90deg);
}

.goal-modal-body {
  padding: 30px;
}

/* è¨­å®šæ–¹æ³•é¸æŠç”»é¢ */
.goal-step {
  min-height: 300px;
}

.goal-method-title {
  font-size: 1.3em;
  font-weight: 600;
  color: #212121;
  text-align: center;
  margin-bottom: 30px;
}

.goal-method-cards {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  margin-bottom: 20px;
}

.goal-method-card {
  background: linear-gradient(145deg, #FFFFFF, #F5F5F5);
  border: 3px solid #E0E0E0;
  border-radius: 16px;
  padding: 40px 20px;
  text-align: center;
  cursor: pointer;
  transition: all 0.3s ease;
}

.goal-method-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
  border-color: #66BB6A;
}

.goal-method-icon {
  font-size: 4em;
  margin-bottom: 15px;
}

.goal-method-name {
  font-size: 1.3em;
  font-weight: 600;
  color: #212121;
  margin-bottom: 10px;
}

.goal-method-desc {
  font-size: 0.95em;
  color: #616161;
}

/* æ”¹å–„ãƒ¬ãƒ™ãƒ«é¸æŠç”»é¢ */
.goal-pattern-title {
  font-size: 1.3em;
  font-weight: 600;
  color: #212121;
  text-align: center;
  margin-bottom: 30px;
}

.goal-pattern-options {
  display: flex;
  flex-direction: column;
  gap: 15px;
  margin-bottom: 30px;
}

.goal-pattern-option {
  display: flex;
  align-items: center;
  padding: 20px;
  background: white;
  border: 3px solid #E0E0E0;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.goal-pattern-option:hover {
  border-color: #66BB6A;
  background: #F1F8E9;
}

.goal-pattern-option input[type="radio"] {
  width: 24px;
  height: 24px;
  margin-right: 20px;
  cursor: pointer;
  accent-color: #66BB6A;
}

.goal-pattern-content {
  flex: 1;
}

.goal-pattern-name {
  font-size: 1.2em;
  font-weight: 600;
  color: #212121;
  margin-bottom: 5px;
}

.goal-pattern-desc {
  font-size: 0.9em;
  color: #616161;
}

/* ã‚¹ãƒ†ãƒƒãƒ—ãƒœã‚¿ãƒ³ */
.goal-step-buttons {
  display: flex;
  gap: 15px;
  margin-top: 30px;
}

.btn-goal-back {
  flex: 1;
  padding: 15px;
  background: white;
  color: #616161;
  border: 2px solid #E0E0E0;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-goal-back:hover {
  background: #F5F5F5;
  border-color: #BDBDBD;
}

.btn-goal-apply,
.btn-goal-save {
  flex: 2;
  padding: 15px;
  background: linear-gradient(135deg, #66BB6A, #43A047);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-goal-apply:hover,
.btn-goal-save:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(102, 187, 106, 0.4);
}
}

.goal-section {
  margin-bottom: 25px;
  padding-bottom: 25px;
  border-bottom: 1px solid #E0E0E0;
}

.goal-section:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

.goal-section-title {
  font-size: 1.2em;
  color: #F57C00;
  margin-bottom: 15px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.goal-input-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 15px;
  margin-bottom: 15px;
}

.goal-input-group {
  display: flex;
  flex-direction: column;
}

.goal-input-group label {
  font-size: 0.9em;
  color: #666;
  margin-bottom: 5px;
  font-weight: 600;
}

.goal-input-group input {
  padding: 12px;
  border: 2px solid #E0E0E0;
  border-radius: 8px;
  font-size: 1em;
  transition: all 0.3s;
  text-align: center;
}

.goal-input-group input:focus {
  outline: none;
  border-color: #FFB300;
  box-shadow: 0 0 0 3px rgba(255, 179, 0, 0.1);
}

.goal-input-group input.error {
  border-color: #EF5350;
}

.goal-error-message {
  color: #EF5350;
  font-size: 0.85em;
  margin-top: 4px;
  display: none;
}

.goal-error-message.show {
  display: block;
}

.goal-hint {
  font-size: 0.85em;
  color: #9E9E9E;
  margin-top: 8px;
  padding: 10px;
  background: #F5F5F5;
  border-radius: 6px;
  display: flex;
  align-items: flex-start;
  gap: 8px;
}

.goal-hint-icon {
  flex-shrink: 0;
  margin-top: 2px;
}

.goal-current-info {
  background: linear-gradient(145deg, #E3F2FD, #FFFFFF);
  border: 2px solid #90CAF9;
  border-radius: 12px;
  padding: 15px;
  margin-bottom: 15px;
}

.goal-current-title {
  font-size: 0.9em;
  color: #1976D2;
  font-weight: 600;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 6px;
}

.goal-current-value {
  font-size: 1.2em;
  font-weight: bold;
  color: #212121;
}

.goal-buttons {
  display: flex;
  gap: 12px;
  margin-top: 25px;
}

.btn-goal-save {
  flex: 1;
  padding: 15px;
  background: linear-gradient(135deg, #F57C00, #FFB300);
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-goal-save:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(245, 124, 0, 0.4);
}

.btn-goal-cancel {
  flex: 1;
  padding: 15px;
  background: white;
  color: #616161;
  border: 2px solid #E0E0E0;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.3s;
}

.btn-goal-cancel:hover {
  background: #F5F5F5;
  border-color: #BDBDBD;
}

@media (max-width: 768px) {
  .goal-modal-content {
    max-height: 95vh;
  }

  .goal-modal-body {
    padding: 20px;
  }

  .goal-input-row {
    grid-template-columns: 1fr;
  }

  .goal-buttons {
    flex-direction: column;
  }
}
</style>
</head>
<body>

<div class="container">
  <!-- ãƒ’ãƒ¼ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
  <section class="hero-section">
    <div class="hero-icon">ğŸ</div>
    <h1 class="hero-title">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç®¡ç†ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h1>
    <p class="hero-subtitle">å¥åº·çš„ãªæ¯æ—¥ã‚’ã‚µãƒãƒ¼ãƒˆ</p>
    <a href="calendar.html" class="hero-cta hidden" id="hero-cta">ğŸ“… ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’é–‹ã</a>
  </section>

  <!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®šï¼ˆåˆå›ã®ã¿è¡¨ç¤ºï¼‰ -->
  <div class="card profile-setup-card fade-in" id="profile-setup">
    <div class="setup-header">
      <h2 class="setup-title">ğŸ‘¤ ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¨­å®š</h2>
      <p class="setup-subtitle">ã‚ãªãŸã®åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
    </div>

    <form id="profile-form">
      <div class="form-group">
        <label class="form-label">æ€§åˆ¥</label>
        <div class="radio-group">
          <div class="radio-option">
            <input type="radio" id="gender-male" name="gender" value="male">
            <label for="gender-male">ç”·æ€§</label>
          </div>
          <div class="radio-option">
            <input type="radio" id="gender-female" name="gender" value="female">
            <label for="gender-female">å¥³æ€§</label>
          </div>
          <div class="radio-option">
            <input type="radio" id="gender-other" name="gender" value="other">
            <label for="gender-other">ãã®ä»–</label>
          </div>
        </div>
        <div class="error-message" id="error-gender"></div>
      </div>

      <div class="form-group">
        <label class="form-label" for="age">å¹´é½¢</label>
        <div class="input-with-unit">
          <input type="number" id="age" class="form-input" placeholder="30" min="10" max="120">
          <span class="unit">æ­³</span>
        </div>
        <div class="error-message" id="error-age"></div>
      </div>

      <div class="form-group">
        <label class="form-label" for="height">èº«é•·ï¼ˆä»»æ„ï¼‰</label>
        <div class="input-with-unit">
          <input type="number" id="height" class="form-input" placeholder="170" min="100" max="250">
          <span class="unit">cm</span>
        </div>
        <p class="form-hint">BMIè¨ˆç®—ã«ä½¿ç”¨ã•ã‚Œã¾ã™</p>
        <div class="error-message" id="error-height"></div>
      </div>

      <div class="form-group">
        <label class="form-label" for="weight">ä½“é‡</label>
        <div class="input-with-unit">
          <input type="number" id="weight" class="form-input" placeholder="65" min="30" max="200" step="0.1">
          <span class="unit">kg</span>
        </div>
        <div class="error-message" id="error-weight"></div>
      </div>

      <div class="form-group">
        <label class="form-label">æ´»å‹•ãƒ¬ãƒ™ãƒ«</label>
        <div class="radio-group vertical">
          <div class="radio-option">
            <input type="radio" id="activity-sedentary" name="activityLevel" value="sedentary">
            <label for="activity-sedentary">ã»ã¨ã‚“ã©é‹å‹•ã—ãªã„</label>
          </div>
          <div class="radio-option">
            <input type="radio" id="activity-light" name="activityLevel" value="light">
            <label for="activity-light">è»½ã„é‹å‹•ï¼ˆé€±1-2å›ï¼‰</label>
          </div>
          <div class="radio-option">
            <input type="radio" id="activity-moderate" name="activityLevel" value="moderate" checked>
            <label for="activity-moderate">ä¸­ç¨‹åº¦ã®é‹å‹•ï¼ˆé€±3-5å›ï¼‰</label>
          </div>
          <div class="radio-option">
            <input type="radio" id="activity-intense" name="activityLevel" value="intense">
            <label for="activity-intense">æ¿€ã—ã„é‹å‹•ï¼ˆé€±6-7å›ï¼‰</label>
          </div>
        </div>
      </div>

      <button type="submit" class="btn btn-primary">âœ… å®Œäº†ã—ã¦ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã¸</button>
      <a href="calendar.html" class="skip-link">ã‚¹ã‚­ãƒƒãƒ— â†’</a>
    </form>
  </div>

  <!-- ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤ºï¼ˆç™»éŒ²æ¸ˆã¿ã®å ´åˆï¼‰ -->
  <div class="card profile-display-card fade-in hidden" id="profile-display">
    <div class="profile-header">
      <div class="card-title">ğŸ‘¤ ã‚ãªãŸã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</div>
      <div class="profile-name" id="profile-name">30æ­³ãƒ»ç”·æ€§</div>
    </div>

    <div class="profile-info-grid">
      <div class="profile-info-item">
        <span class="profile-info-label">èº«é•·</span>
        <span class="profile-info-value" id="display-height">170 cm</span>
      </div>

      <div class="profile-info-item">
        <span class="profile-info-label">ä½“é‡</span>
        <span class="profile-info-value" id="display-weight">65 kg</span>
      </div>

      <div class="profile-info-item">
        <span class="profile-info-label">æ´»å‹•ãƒ¬ãƒ™ãƒ«</span>
        <span class="profile-info-value" id="display-activity">ä¸­ç¨‹åº¦ã®é‹å‹•</span>
      </div>

      <div class="profile-info-item">
        <span class="profile-info-label">æ€§åˆ¥</span>
        <span class="profile-info-value" id="display-gender">ç”·æ€§</span>
      </div>

      <div class="profile-info-item">
        <span class="profile-info-label">BMI</span>
        <span class="profile-info-value" id="display-bmi">22.5 (æ¨™æº–)</span>
      </div>

      <div class="profile-info-item">
        <span class="profile-info-label">åŸºç¤ä»£è¬</span>
        <span class="profile-info-value" id="display-bmr">ç´„1,650 kcal/æ—¥</span>
      </div>
    </div>

    <button class="btn btn-edit" onclick="editProfile()">âœï¸ ç·¨é›†</button>
  </div>

  <!-- æœˆé–“ç›®æ¨™ã‚«ãƒ¼ãƒ‰ï¼ˆç™»éŒ²æ¸ˆã¿ã®å ´åˆï¼‰ -->
  <div class="card goal-display-card fade-in hidden" id="goal-display">
    <div class="goal-display-header">
      <div class="card-title">ğŸ¯ ä»Šæœˆã®ç›®æ¨™</div>
    </div>

    <div class="goal-display-grid" id="goal-display-content">
      <div class="goal-display-item">
        <span class="goal-display-label">è¡€åœ§ç›®æ¨™</span>
        <span class="goal-display-value" id="display-goal-bp">120/80 mmHg</span>
      </div>

      <div class="goal-display-item">
        <span class="goal-display-label">ä½“é‡ç›®æ¨™</span>
        <span class="goal-display-value" id="display-goal-weight">65.0 kg</span>
      </div>

      <div class="goal-display-item">
        <span class="goal-display-label">ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ—¥æ•°</span>
        <span class="goal-display-value" id="display-goal-days">12 æ—¥</span>
      </div>

      <div class="goal-display-item">
        <span class="goal-display-label">ç·é‹å‹•æ™‚é–“</span>
        <span class="goal-display-value" id="display-goal-time">600 åˆ†</span>
      </div>

      <div class="goal-display-item">
        <span class="goal-display-label">ç·æ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼</span>
        <span class="goal-display-value" id="display-goal-calories">3,000 kcal</span>
      </div>
    </div>

    <button class="btn btn-edit" onclick="openGoalModal()">âœï¸ ç·¨é›†</button>
  </div>

  <!-- ãƒ¡ã‚¤ãƒ³ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç™»éŒ²æ¸ˆã¿ã®å ´åˆï¼‰ -->
  <section class="fade-in hidden" id="main-navigation">
    <a href="calendar.html" class="nav-card">
      <div class="nav-card-content">
        <div class="nav-card-icon">ğŸ“…</div>
        <div class="nav-card-text">
          <div class="nav-card-title">ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’é–‹ã</div>
          <div class="nav-card-subtitle">æœˆåˆ¥ã®è¨˜éŒ²ã‚’ç¢ºèªãƒ»å…¥åŠ›</div>
        </div>
      </div>
      <div class="nav-card-arrow">â†’</div>
    </a>

    <a href="yearly-summary.html" class="nav-card">
      <div class="nav-card-content">
        <div class="nav-card-icon">ğŸ“Š</div>
        <div class="nav-card-text">
          <div class="nav-card-title">å¹´é–“ã‚µãƒãƒªãƒ¼ã‚’è¦‹ã‚‹</div>
          <div class="nav-card-subtitle">1å¹´é–“ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æ</div>
        </div>
      </div>
      <div class="nav-card-arrow">â†’</div>
    </a>

    <a href="features.html" class="nav-card">
      <div class="nav-card-content">
        <div class="nav-card-icon">ğŸ“–</div>
        <div class="nav-card-text">
          <div class="nav-card-title">ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰</div>
          <div class="nav-card-subtitle">æ©Ÿèƒ½ã®è©³ã—ã„èª¬æ˜</div>
        </div>
      </div>
      <div class="nav-card-arrow">â†’</div>
    </a>

    <a href="#settings" class="nav-card" onclick="alert('è¨­å®šç”»é¢ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™'); return false;">
      <div class="nav-card-content">
        <div class="nav-card-icon">âš™ï¸</div>
        <div class="nav-card-text">
          <div class="nav-card-title">è¨­å®šã¨ãƒ‡ãƒ¼ã‚¿ç®¡ç†</div>
          <div class="nav-card-subtitle">ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ç›®æ¨™è¨­å®š</div>
        </div>
      </div>
      <div class="nav-card-arrow">â†’</div>
    </a>
  </section>
</div>

<!-- æœˆé–“ç›®æ¨™è¨­å®šãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div class="goal-modal" id="goalModal">
  <div class="goal-modal-content">
    <div class="goal-modal-header">
      <h2 id="modal-header-title">ğŸ¯ æœˆé–“ç›®æ¨™è¨­å®š</h2>
      <button class="goal-close-btn" onclick="closeGoalModal()">&times;</button>
    </div>
    <div class="goal-modal-body">
      
      <!-- ç¬¬1æ®µéš: è¨­å®šæ–¹æ³•ã®é¸æŠ -->
      <div id="goal-step1" class="goal-step">
        <div class="goal-method-title">è¨­å®šæ–¹æ³•ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
        
        <div class="goal-method-cards">
          <div class="goal-method-card" onclick="selectGoalMethod('auto')">
            <div class="goal-method-icon">ğŸ¤–</div>
            <div class="goal-method-name">è‡ªå‹•è¨­å®š</div>
            <div class="goal-method-desc">å‰æœˆå®Ÿç¸¾ã‹ã‚‰è‡ªå‹•è¨ˆç®—</div>
          </div>
          
          <div class="goal-method-card" onclick="selectGoalMethod('custom')">
            <div class="goal-method-icon">âœï¸</div>
            <div class="goal-method-name">è‡ªåˆ†ã§ã‚«ã‚¹ã‚¿ãƒ </div>
            <div class="goal-method-desc">ã™ã¹ã¦æ‰‹å‹•ã§è¨­å®š</div>
          </div>
        </div>
      </div>
      
      <!-- ç¬¬2æ®µéš-A: è‡ªå‹•è¨­å®šï¼ˆæ”¹å–„ãƒ¬ãƒ™ãƒ«é¸æŠï¼‰ -->
      <div id="goal-step2-auto" class="goal-step" style="display: none;">
        <div class="goal-pattern-title">æ”¹å–„ãƒ¬ãƒ™ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„</div>
        
        <div class="goal-pattern-options">
          <label class="goal-pattern-option">
            <input type="radio" name="goal-pattern" value="maintain" checked>
            <div class="goal-pattern-content">
              <div class="goal-pattern-name">ğŸ“Š ç¾çŠ¶ç¶­æŒ</div>
              <div class="goal-pattern-desc">å‰æœˆã¨åŒã˜ç›®æ¨™</div>
            </div>
          </label>
          
          <label class="goal-pattern-option">
            <input type="radio" name="goal-pattern" value="moderate">
            <div class="goal-pattern-content">
              <div class="goal-pattern-name">ğŸ¯ è»½ã„æ”¹å–„</div>
              <div class="goal-pattern-desc">è¡€åœ§-2%, ä½“é‡-1%, é‹å‹•+5%</div>
            </div>
          </label>
          
          <label class="goal-pattern-option">
            <input type="radio" name="goal-pattern" value="aggressive">
            <div class="goal-pattern-content">
              <div class="goal-pattern-name">ğŸ”¥ ç©æ¥µçš„æ”¹å–„</div>
              <div class="goal-pattern-desc">è¡€åœ§-5%, ä½“é‡-3%, é‹å‹•+15%</div>
            </div>
          </label>
        </div>
        
        <div class="goal-step-buttons">
          <button class="btn-goal-back" onclick="goBackToStep1()">â† å‰ã®ç”»é¢</button>
          <button class="btn-goal-apply" onclick="applyAutoGoals()">ã“ã®å†…å®¹ã§è¨­å®š</button>
        </div>
      </div>
      
      <!-- ç¬¬2æ®µéš-B: ã‚«ã‚¹ã‚¿ãƒ è¨­å®šï¼ˆå€‹åˆ¥å…¥åŠ›ï¼‰ -->
      <div id="goal-step2-custom" class="goal-step" style="display: none;">
      <!-- ç¬¬2æ®µéš-B: ã‚«ã‚¹ã‚¿ãƒ è¨­å®šï¼ˆå€‹åˆ¥å…¥åŠ›ï¼‰ -->
      <div id="goal-step2-custom" class="goal-step" style="display: none;">
        
        <!-- è¡€åœ§ç›®æ¨™ -->
        <div class="goal-section">
          <h3 class="goal-section-title">ğŸ’‰ è¡€åœ§ç›®æ¨™</h3>
          <div class="goal-current-info" id="current-bp-info" style="display: none;">
            <div class="goal-current-title">ğŸ“Š ç¾åœ¨ã®å¹³å‡è¡€åœ§</div>
            <div class="goal-current-value" id="current-bp-value">--/-- mmHg</div>
          </div>
          <div class="goal-input-row">
            <div class="goal-input-group">
              <label>åç¸®æœŸè¡€åœ§ï¼ˆæœ€é«˜ï¼‰</label>
              <input type="number" id="goal-systolic" min="100" max="139" placeholder="120">
              <div class="goal-error-message" id="error-systolic"></div>
            </div>
            <div class="goal-input-group">
              <label>æ‹¡å¼µæœŸè¡€åœ§ï¼ˆæœ€ä½ï¼‰</label>
              <input type="number" id="goal-diastolic" min="70" max="89" placeholder="80">
              <div class="goal-error-message" id="error-diastolic"></div>
            </div>
          </div>
          <div class="goal-hint">
            <span class="goal-hint-icon">ğŸ’¡</span>
            <span>å¥åº·ç®¡ç†ã®ãŸã‚ã€100-139 / 70-89 mmHgã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„</span>
          </div>
        </div>

        <!-- ä½“é‡ç›®æ¨™ -->
        <div class="goal-section">
          <h3 class="goal-section-title">âš–ï¸ ä½“é‡ç›®æ¨™</h3>
          <div class="goal-current-info" id="current-weight-info" style="display: none;">
            <div class="goal-current-title">ğŸ“Š ç¾åœ¨ã®å¹³å‡ä½“é‡</div>
            <div class="goal-current-value" id="current-weight-value">-- kg (BMI: --)</div>
          </div>
          <div class="goal-input-row">
            <div class="goal-input-group">
              <label>ç›®æ¨™ä½“é‡ï¼ˆkgï¼‰</label>
              <input type="number" id="goal-weight" step="0.1" placeholder="65.0">
              <div class="goal-error-message" id="error-goal-weight"></div>
            </div>
          </div>
          <div class="goal-hint">
            <span class="goal-hint-icon">ğŸ’¡</span>
            <span id="weight-hint">å¥åº·ç®¡ç†ã®ãŸã‚ã€BMI 18.5-30ã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„</span>
          </div>
        </div>

        <!-- ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç›®æ¨™ -->
        <div class="goal-section">
          <h3 class="goal-section-title">ğŸƒ ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç›®æ¨™</h3>
          <div class="goal-current-info" id="current-training-info" style="display: none;">
            <div class="goal-current-title">ğŸ“Š ä»Šæœˆã®å®Ÿç¸¾</div>
            <div class="goal-current-value" id="current-training-value">
              -- æ—¥ / -- åˆ† / -- kcal
            </div>
          </div>
          <div class="goal-input-row">
            <div class="goal-input-group">
              <label>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ—¥æ•°ï¼ˆæ—¥ï¼‰</label>
              <input type="number" id="goal-days" min="1" max="31" placeholder="12">
              <div class="goal-error-message" id="error-days"></div>
            </div>
            <div class="goal-input-group">
              <label>ç·é‹å‹•æ™‚é–“ï¼ˆåˆ†ï¼‰</label>
              <input type="number" id="goal-time" min="30" max="3000" placeholder="600">
              <div class="goal-error-message" id="error-time"></div>
            </div>
            <div class="goal-input-group">
              <label>ç·æ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼ï¼ˆkcalï¼‰</label>
              <input type="number" id="goal-calories" min="100" max="15000" placeholder="3000">
              <div class="goal-error-message" id="error-calories"></div>
            </div>
          </div>
          <div class="goal-hint">
            <span class="goal-hint-icon">ğŸ’¡</span>
            <span>ç„¡ç†ã®ãªã„ç›®æ¨™ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ã€‚é”æˆã§ããŸã‚‰å°‘ã—ãšã¤ä¸Šã’ã¦ã„ã‘ã¾ã™</span>
          </div>
        </div>

        <!-- ãƒœã‚¿ãƒ³ -->
        <div class="goal-step-buttons">
          <button class="btn-goal-back" onclick="goBackToStep1()">â† å‰ã®ç”»é¢</button>
          <button class="btn-goal-save" onclick="saveCustomGoals()">ğŸ’¾ ç›®æ¨™ã‚’ä¿å­˜</button>
        </div>
      </div>
      
    </div>
  </div>
</div>

<script>
// ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ã‚­ãƒ¼
const PROFILE_KEY = 'user_profile';

// æœˆåˆ¥ã®ã‚¢ã‚¤ã‚³ãƒ³ã¨è‰²è¨­å®š
const monthThemes = {
  0: { icon: 'â„ï¸', bg: 'linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 50%, #90CAF9 100%)' },  // 1æœˆ: é›ª
  1: { icon: 'ğŸ’—', bg: 'linear-gradient(135deg, #FCE4EC 0%, #F8BBD0 50%, #F48FB1 100%)' },  // 2æœˆ: ãƒãƒ¼ãƒˆ
  2: { icon: 'ğŸŒ¸', bg: 'linear-gradient(135deg, #F1F8E9 0%, #DCEDC8 50%, #C5E1A5 100%)' },  // 3æœˆ: æ¡œ
  3: { icon: 'ğŸŒ·', bg: 'linear-gradient(135deg, #FFF3E0 0%, #FFE0B2 50%, #FFCC80 100%)' },  // 4æœˆ: ãƒãƒ¥ãƒ¼ãƒªãƒƒãƒ—
  4: { icon: 'ğŸŒ¿', bg: 'linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 50%, #A5D6A7 100%)' },  // 5æœˆ: æ–°ç·‘
  5: { icon: 'ğŸŒˆ', bg: 'linear-gradient(135deg, #F3E5F5 0%, #E1BEE7 50%, #CE93D8 100%)' },  // 6æœˆ: è™¹ï¼ˆæ¢…é›¨ï¼‰
  6: { icon: 'ğŸŒŠ', bg: 'linear-gradient(135deg, #E1F5FE 0%, #B3E5FC 50%, #81D4FA 100%)' },  // 7æœˆ: æµ·
  7: { icon: 'ğŸŒ»', bg: 'linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 50%, #EF9A9A 100%)' },  // 8æœˆ: ã²ã¾ã‚ã‚Š
  8: { icon: 'ğŸ‚', bg: 'linear-gradient(135deg, #E0F2F1 0%, #B2DFDB 50%, #80CBC4 100%)' },  // 9æœˆ: ç´…è‘‰å§‹ã¾ã‚Š
  9: { icon: 'ğŸ', bg: 'linear-gradient(135deg, #FFF9C4 0%, #FFECB3 50%, #FFE082 100%)' },  // 10æœˆ: ç´…è‘‰
  10: { icon: 'ğŸ„', bg: 'linear-gradient(135deg, #EFEBE9 0%, #D7CCC8 50%, #BCAAA4 100%)' }, // 11æœˆ: ãã®ã“
  11: { icon: 'â›„', bg: 'linear-gradient(135deg, #ECEFF1 0%, #CFD8DC 50%, #B0BEC5 100%)' }  // 12æœˆ: é›ªã ã‚‹ã¾
};

// ç¾åœ¨ã®æœˆã‚’å–å¾—
function getCurrentMonth() {
  return new Date().getMonth();
}

// æœˆåˆ¥ãƒ†ãƒ¼ãƒã®é©ç”¨
function applyMonthTheme() {
  const currentMonth = getCurrentMonth();
  const theme = monthThemes[currentMonth];
  
  // èƒŒæ™¯è‰²ã®å¤‰æ›´
  document.body.style.background = theme.bg;
  
  // ã‚¢ã‚¤ã‚³ãƒ³ã®å¤‰æ›´
  document.querySelector('.hero-icon').textContent = theme.icon;
}

// æ´»å‹•ãƒ¬ãƒ™ãƒ«ã®è¡¨ç¤ºå
const activityLabels = {
  sedentary: 'ã»ã¨ã‚“ã©é‹å‹•ã—ãªã„',
  light: 'è»½ã„é‹å‹•ï¼ˆé€±1-2å›ï¼‰',
  moderate: 'ä¸­ç¨‹åº¦ã®é‹å‹•ï¼ˆé€±3-5å›ï¼‰',
  intense: 'æ¿€ã—ã„é‹å‹•ï¼ˆé€±6-7å›ï¼‰'
};

// æ€§åˆ¥ã®è¡¨ç¤ºå
const genderLabels = {
  male: 'ç”·æ€§',
  female: 'å¥³æ€§',
  other: 'ãã®ä»–'
};

// æ´»å‹•ãƒ¬ãƒ™ãƒ«ã®ä¿‚æ•°
const activityMultipliers = {
  sedentary: 1.2,
  light: 1.375,
  moderate: 1.55,
  intense: 1.725
};

// BMIè¨ˆç®—
function calculateBMI(weight, height) {
  if (!height || height === 0) return null;
  const heightM = height / 100;
  return (weight / (heightM * heightM)).toFixed(1);
}

// BMIåˆ¤å®š
function getBMIStatus(bmi) {
  if (!bmi) return { class: '', text: '' };
  if (bmi < 18.5) return { class: 'bmi-low', text: 'ä½ä½“é‡' };
  if (bmi < 25) return { class: 'bmi-normal', text: 'æ¨™æº–' };
  if (bmi < 30) return { class: 'bmi-high', text: 'è‚¥æº€ï¼ˆ1åº¦ï¼‰' };
  return { class: 'bmi-very-high', text: 'è‚¥æº€ï¼ˆ2åº¦ä»¥ä¸Šï¼‰' };
}

// åŸºç¤ä»£è¬è¨ˆç®—ï¼ˆHarris-Benedictå¼ï¼‰
function calculateBMR(gender, weight, height, age) {
  if (!weight || !age) return null;
  
  if (gender === 'male') {
    if (!height) {
      // èº«é•·ãŒãªã„å ´åˆã®ç°¡æ˜“è¨ˆç®—
      return Math.round(66.47 + (13.75 * weight) - (6.76 * age));
    }
    return Math.round(66.47 + (13.75 * weight) + (5.00 * height) - (6.76 * age));
  } else if (gender === 'female') {
    if (!height) {
      return Math.round(655.10 + (9.56 * weight) - (4.68 * age));
    }
    return Math.round(655.10 + (9.56 * weight) + (1.85 * height) - (4.68 * age));
  } else {
    // ãã®ä»–ã®æ€§åˆ¥ã®å ´åˆã¯å¹³å‡ã‚’ä½¿ç”¨
    if (!height) {
      const male = 66.47 + (13.75 * weight) - (6.76 * age);
      const female = 655.10 + (9.56 * weight) - (4.68 * age);
      return Math.round((male + female) / 2);
    }
    const male = 66.47 + (13.75 * weight) + (5.00 * height) - (6.76 * age);
    const female = 655.10 + (9.56 * weight) + (1.85 * height) - (4.68 * age);
    return Math.round((male + female) / 2);
  }
}

// ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
function loadProfile() {
  const profileStr = localStorage.getItem(PROFILE_KEY);
  if (profileStr) {
    return JSON.parse(profileStr);
  }
  return null;
}

// ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
function saveProfile(profile) {
  profile.updatedAt = new Date().toISOString();
  if (!profile.createdAt) {
    profile.createdAt = profile.updatedAt;
  }
  localStorage.setItem(PROFILE_KEY, JSON.stringify(profile));
}

// ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤ºã®æ›´æ–°
function updateProfileDisplay(profile) {
  // åå‰è¡¨ç¤ºï¼ˆå¹´é½¢ã¨æ€§åˆ¥ï¼‰
  const genderText = genderLabels[profile.gender] || '---';
  document.getElementById('profile-name').textContent = 
    `${profile.age}æ­³ãƒ»${genderText}`;

  // åŸºæœ¬æƒ…å ±
  document.getElementById('display-height').textContent = 
    profile.height ? `${profile.height} cm` : 'æœªå…¥åŠ›';
  document.getElementById('display-weight').textContent = 
    profile.weight ? `${profile.weight} kg` : '---';
  document.getElementById('display-activity').textContent = 
    activityLabels[profile.activityLevel] || 'æœªè¨­å®š';
  document.getElementById('display-gender').textContent = genderText;

  // BMIè¨ˆç®—ã¨è¡¨ç¤º
  const bmi = calculateBMI(profile.weight, profile.height);
  const bmiDisplay = document.getElementById('display-bmi');
  if (bmi) {
    const status = getBMIStatus(parseFloat(bmi));
    bmiDisplay.innerHTML = `<span class="${status.class}">${bmi}</span> <span style="font-size: 0.8em;">(${status.text})</span>`;
  } else {
    bmiDisplay.innerHTML = '<span style="color: #9E9E9E;">èº«é•·ã‚’å…¥åŠ›ã™ã‚‹ã¨<br>è¨ˆç®—ã•ã‚Œã¾ã™</span>';
  }

  // åŸºç¤ä»£è¬è¨ˆç®—ã¨è¡¨ç¤º
  const bmr = calculateBMR(profile.gender, profile.weight, profile.height, profile.age);
  const bmrDisplay = document.getElementById('display-bmr');
  if (bmr) {
    bmrDisplay.textContent = `ç´„${bmr.toLocaleString()} kcal/æ—¥`;
  } else {
    bmrDisplay.textContent = '---';
  }
}

// ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
function validateProfile(profile) {
  const errors = [];
  
  // æ€§åˆ¥
  if (!profile.gender) {
    errors.push({ field: 'gender', message: 'æ€§åˆ¥ã‚’é¸æŠã—ã¦ãã ã•ã„' });
  }
  
  // å¹´é½¢
  if (!profile.age || profile.age < 10 || profile.age > 120) {
    errors.push({ field: 'age', message: '10æ­³ã‹ã‚‰120æ­³ã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„' });
  }
  
  // ä½“é‡
  if (!profile.weight || profile.weight < 30 || profile.weight > 200) {
    errors.push({ field: 'weight', message: '30kgã‹ã‚‰200kgã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„' });
  }
  
  // èº«é•·ï¼ˆå…¥åŠ›ãŒã‚ã‚‹å ´åˆã®ã¿ï¼‰
  if (profile.height && (profile.height < 100 || profile.height > 250)) {
    errors.push({ field: 'height', message: '100cmã‹ã‚‰250cmã®ç¯„å›²ã§å…¥åŠ›ã—ã¦ãã ã•ã„' });
  }
  
  return errors;
}

// ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
function showErrors(errors) {
  // ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ã‚’ã‚¯ãƒªã‚¢
  document.querySelectorAll('.error-message').forEach(el => {
    el.classList.remove('show');
  });
  document.querySelectorAll('.form-input').forEach(el => {
    el.classList.remove('error');
  });
  
  // ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤º
  errors.forEach(error => {
    const errorEl = document.getElementById(`error-${error.field}`);
    const inputEl = document.getElementById(error.field);
    
    if (errorEl) {
      errorEl.classList.add('show');
      errorEl.textContent = error.message;
    }
    
    if (inputEl) {
      inputEl.classList.add('error');
    }
  });
}

// ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡
document.getElementById('profile-form').addEventListener('submit', function(e) {
  e.preventDefault();
  
  // ãƒ‡ãƒ¼ã‚¿å–å¾—
  const profile = {
    gender: document.querySelector('input[name="gender"]:checked')?.value,
    age: parseInt(document.getElementById('age').value) || null,
    height: parseInt(document.getElementById('height').value) || null,
    weight: parseFloat(document.getElementById('weight').value) || null,
    activityLevel: document.querySelector('input[name="activityLevel"]:checked')?.value || 'moderate'
  };
  
  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  const errors = validateProfile(profile);
  
  if (errors.length > 0) {
    showErrors(errors);
    return;
  }
  
  // ä¿å­˜
  saveProfile(profile);
  
  // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒšãƒ¼ã‚¸ã¸é·ç§»
  window.location.href = 'calendar.html';
});

// ç·¨é›†ãƒœã‚¿ãƒ³
function editProfile() {
  const profile = loadProfile();
  if (!profile) return;
  
  // ãƒ•ã‚©ãƒ¼ãƒ ã«å€¤ã‚’è¨­å®š
  if (profile.gender) {
    document.getElementById(`gender-${profile.gender}`).checked = true;
  }
  if (profile.age) {
    document.getElementById('age').value = profile.age;
  }
  if (profile.height) {
    document.getElementById('height').value = profile.height;
  }
  if (profile.weight) {
    document.getElementById('weight').value = profile.weight;
  }
  if (profile.activityLevel) {
    document.getElementById(`activity-${profile.activityLevel}`).checked = true;
  }
  
  // è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
  document.getElementById('profile-display').classList.add('hidden');
  document.getElementById('main-navigation').classList.add('hidden');
  document.getElementById('profile-setup').classList.remove('hidden');
  document.getElementById('hero-cta').classList.add('hidden');
  
  // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
  document.getElementById('profile-setup').scrollIntoView({ behavior: 'smooth' });
}

// æœˆé–“ç›®æ¨™è¨­å®šæ©Ÿèƒ½
function openGoalModal() {
  document.getElementById('goalModal').classList.add('active');
  showStep1();
}

function closeGoalModal() {
  document.getElementById('goalModal').classList.remove('active');
  clearGoalErrors();
  // ã™ã¹ã¦ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’éè¡¨ç¤ºã«
  document.getElementById('goal-step1').style.display = 'block';
  document.getElementById('goal-step2-auto').style.display = 'none';
  document.getElementById('goal-step2-custom').style.display = 'none';
}

// ç¬¬1æ®µéšã‚’è¡¨ç¤º
function showStep1() {
  document.getElementById('goal-step1').style.display = 'block';
  document.getElementById('goal-step2-auto').style.display = 'none';
  document.getElementById('goal-step2-custom').style.display = 'none';
  document.getElementById('modal-header-title').textContent = 'ğŸ¯ æœˆé–“ç›®æ¨™è¨­å®š';
}

// ç¬¬1æ®µéšã«æˆ»ã‚‹
function goBackToStep1() {
  showStep1();
}

// è¨­å®šæ–¹æ³•ã‚’é¸æŠ
function selectGoalMethod(method) {
  if (method === 'auto') {
    // è‡ªå‹•è¨­å®šã®å ´åˆï¼šç¬¬2æ®µéš-Aï¼ˆæ”¹å–„ãƒ¬ãƒ™ãƒ«é¸æŠï¼‰ã‚’è¡¨ç¤º
    document.getElementById('goal-step1').style.display = 'none';
    document.getElementById('goal-step2-auto').style.display = 'block';
    document.getElementById('goal-step2-custom').style.display = 'none';
    document.getElementById('modal-header-title').textContent = 'ğŸ¤– è‡ªå‹•è¨­å®š';
  } else if (method === 'custom') {
    // ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã®å ´åˆï¼šç¬¬2æ®µéš-Bï¼ˆå€‹åˆ¥å…¥åŠ›ï¼‰ã‚’è¡¨ç¤º
    document.getElementById('goal-step1').style.display = 'none';
    document.getElementById('goal-step2-auto').style.display = 'none';
    document.getElementById('goal-step2-custom').style.display = 'block';
    document.getElementById('modal-header-title').textContent = 'âœï¸ ã‚«ã‚¹ã‚¿ãƒ è¨­å®š';
    loadCurrentMonthData();
    loadSavedGoals();
  }
}

// è‡ªå‹•è¨­å®šã‚’é©ç”¨
function applyAutoGoals() {
  const pattern = document.querySelector('input[name="goal-pattern"]:checked').value;
  const previousMonthData = getPreviousMonthData();
  
  if (!previousMonthData.hasData) {
    // å‰æœˆãƒ‡ãƒ¼ã‚¿ãŒãªã„å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ç”¨
    setDefaultGoals();
    alert('å‰æœˆã®ãƒ‡ãƒ¼ã‚¿ãŒãªã„ãŸã‚ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®šã—ã¾ã—ãŸã€‚\nå¿…è¦ã«å¿œã˜ã¦èª¿æ•´ã—ã¦ãã ã•ã„ã€‚');
  } else {
    // å‰æœˆãƒ‡ãƒ¼ã‚¿ã‚’ãƒ™ãƒ¼ã‚¹ã«è¨ˆç®—
    calculateGoalsFromPrevious(previousMonthData, pattern);
  }
  
  // è‡ªå‹•è¨­å®šå®Œäº†å¾Œã€ã‚«ã‚¹ã‚¿ãƒ è¨­å®šç”»é¢ã«é·ç§»ï¼ˆç¢ºèªãƒ»å¾®èª¿æ•´å¯èƒ½ï¼‰
  document.getElementById('goal-step2-auto').style.display = 'none';
  document.getElementById('goal-step2-custom').style.display = 'block';
  document.getElementById('modal-header-title').textContent = 'âœï¸ ç›®æ¨™ã®ç¢ºèªãƒ»èª¿æ•´';
  loadCurrentMonthData();
}

// å‰æœˆãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
function getPreviousMonthData() {
  const currentMonth = new Date().getMonth();
  const currentYear = new Date().getFullYear();
  
  // å‰æœˆã®å¹´æœˆã‚’è¨ˆç®—
  let prevMonth = currentMonth - 1;
  let prevYear = currentYear;
  if (prevMonth < 0) {
    prevMonth = 11;
    prevYear = currentYear - 1;
  }
  
  let bpSum = { systolic: 0, diastolic: 0, count: 0 };
  let weightSum = { total: 0, count: 0 };
  let trainingDays = 0;
  let totalTime = 0;
  let totalCalories = 0;
  
  const daysInMonth = new Date(prevYear, prevMonth + 1, 0).getDate();
  
  for (let day = 1; day <= daysInMonth; day++) {
    const key = `training_${prevYear}_${prevMonth}_${day}`;
    const dataStr = localStorage.getItem(key);
    if (dataStr) {
      try {
        const data = JSON.parse(dataStr);
        
        if (data.bloodPressure) {
          bpSum.systolic += data.bloodPressure.systolic;
          bpSum.diastolic += data.bloodPressure.diastolic;
          bpSum.count++;
        }
        
        if (data.weight) {
          weightSum.total += data.weight;
          weightSum.count++;
        }
        
        if (data.exercises && data.exercises.length > 0) {
          trainingDays++;
        }
        
        if (data.totalTime) {
          totalTime += data.totalTime;
        }
        
        if (data.totalCalories) {
          totalCalories += data.totalCalories;
        }
      } catch (e) {
        console.error('Error parsing data:', e);
      }
    }
  }
  
  return {
    hasData: bpSum.count > 0 || weightSum.count > 0 || trainingDays > 0,
    avgBP: bpSum.count > 0 ? {
      systolic: Math.round(bpSum.systolic / bpSum.count),
      diastolic: Math.round(bpSum.diastolic / bpSum.count)
    } : null,
    avgWeight: weightSum.count > 0 ? weightSum.total / weightSum.count : null,
    trainingDays: trainingDays,
    totalTime: totalTime,
    totalCalories: totalCalories
  };
}

// å‰æœˆãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç›®æ¨™ã‚’è¨ˆç®—
function calculateGoalsFromPrevious(prevData, pattern) {
  const profile = loadProfile();
  
  // è¡€åœ§ç›®æ¨™ã®è¨ˆç®—
  if (prevData.avgBP) {
    let systolic, diastolic;
    
    if (pattern === 'maintain') {
      // ç¾çŠ¶ç¶­æŒ
      systolic = prevData.avgBP.systolic;
      diastolic = prevData.avgBP.diastolic;
    } else if (pattern === 'moderate') {
      // è»½ã„æ”¹å–„ï¼ˆ2%æ¸›ï¼‰
      systolic = Math.round(prevData.avgBP.systolic * 0.98);
      diastolic = Math.round(prevData.avgBP.diastolic * 0.98);
    } else if (pattern === 'aggressive') {
      // ç©æ¥µçš„æ”¹å–„ï¼ˆ5%æ¸›ï¼‰
      systolic = Math.round(prevData.avgBP.systolic * 0.95);
      diastolic = Math.round(prevData.avgBP.diastolic * 0.95);
    }
    
    // ç¯„å›²å†…ã«èª¿æ•´
    systolic = Math.max(100, Math.min(139, systolic));
    diastolic = Math.max(70, Math.min(89, diastolic));
    
    document.getElementById('goal-systolic').value = systolic;
    document.getElementById('goal-diastolic').value = diastolic;
  } else {
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
    document.getElementById('goal-systolic').value = 120;
    document.getElementById('goal-diastolic').value = 80;
  }
  
  // ä½“é‡ç›®æ¨™ã®è¨ˆç®—
  if (prevData.avgWeight) {
    let weight;
    
    if (pattern === 'maintain') {
      weight = prevData.avgWeight;
    } else if (pattern === 'moderate') {
      // è»½ã„æ”¹å–„ï¼ˆ1%æ¸›ï¼‰
      weight = prevData.avgWeight * 0.99;
    } else if (pattern === 'aggressive') {
      // ç©æ¥µçš„æ”¹å–„ï¼ˆ3%æ¸›ï¼‰
      weight = prevData.avgWeight * 0.97;
    }
    
    // BMIç¯„å›²å†…ã«èª¿æ•´
    if (profile && profile.height) {
      const heightM = profile.height / 100;
      const minWeight = 18.5 * heightM * heightM;
      const maxWeight = 30 * heightM * heightM;
      weight = Math.max(minWeight, Math.min(maxWeight, weight));
    }
    
    document.getElementById('goal-weight').value = weight.toFixed(1);
  } else {
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
    if (profile && profile.height) {
      const heightM = profile.height / 100;
      const targetWeight = (22 * heightM * heightM).toFixed(1);
      document.getElementById('goal-weight').value = targetWeight;
    } else {
      document.getElementById('goal-weight').value = 65.0;
    }
  }
  
  // ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç›®æ¨™ã®è¨ˆç®—
  if (prevData.trainingDays > 0) {
    let days, time, calories;
    
    if (pattern === 'maintain') {
      days = prevData.trainingDays;
      time = prevData.totalTime;
      calories = prevData.totalCalories;
    } else if (pattern === 'moderate') {
      // è»½ã„æ”¹å–„ï¼ˆ5%å¢—ï¼‰
      days = Math.ceil(prevData.trainingDays * 1.05);
      time = Math.ceil(prevData.totalTime * 1.05);
      calories = Math.ceil(prevData.totalCalories * 1.05);
    } else if (pattern === 'aggressive') {
      // ç©æ¥µçš„æ”¹å–„ï¼ˆ15%å¢—ï¼‰
      days = Math.ceil(prevData.trainingDays * 1.15);
      time = Math.ceil(prevData.totalTime * 1.15);
      calories = Math.ceil(prevData.totalCalories * 1.15);
    }
    
    // ç¯„å›²å†…ã«èª¿æ•´
    days = Math.max(1, Math.min(31, days));
    time = Math.max(30, Math.min(3000, time));
    calories = Math.max(100, Math.min(15000, calories));
    
    document.getElementById('goal-days').value = days;
    document.getElementById('goal-time').value = time;
    document.getElementById('goal-calories').value = calories;
  } else {
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
    document.getElementById('goal-days').value = 12;
    document.getElementById('goal-time').value = 600;
    document.getElementById('goal-calories').value = 3000;
  }
}

// ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®š
function setDefaultGoals() {
  const profile = loadProfile();
  
  // è¡€åœ§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
  document.getElementById('goal-systolic').value = 120;
  document.getElementById('goal-diastolic').value = 80;
  
  // ä½“é‡ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆBMI 22åŸºæº–ï¼‰
  if (profile && profile.height) {
    const heightM = profile.height / 100;
    const targetWeight = (22 * heightM * heightM).toFixed(1);
    document.getElementById('goal-weight').value = targetWeight;
  } else {
    document.getElementById('goal-weight').value = 65.0;
  }
  
  // ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
  document.getElementById('goal-days').value = 12;
  document.getElementById('goal-time').value = 600;
  document.getElementById('goal-calories').value = 3000;
}
  document.querySelectorAll('.goal-error-message').forEach(el => {
    el.classList.remove('show');
  });
  document.querySelectorAll('.goal-input-group input').forEach(el => {
    el.classList.remove('error');
  });
}

function loadCurrentMonthData() {
  const currentMonth = new Date().getMonth();
  const currentYear = new Date().getFullYear();
  
  // ä»Šæœˆã®ãƒ‡ãƒ¼ã‚¿ã‚’é›†è¨ˆ
  let bpSum = { systolic: 0, diastolic: 0, count: 0 };
  let weightSum = { total: 0, count: 0 };
  let trainingDays = 0;
  let totalTime = 0;
  let totalCalories = 0;
  
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
  
  for (let day = 1; day <= daysInMonth; day++) {
    const key = `training_${currentYear}_${currentMonth}_${day}`;
    const dataStr = localStorage.getItem(key);
    if (dataStr) {
      const data = JSON.parse(dataStr);
      
      if (data.bloodPressure) {
        bpSum.systolic += data.bloodPressure.systolic;
        bpSum.diastolic += data.bloodPressure.diastolic;
        bpSum.count++;
      }
      
      if (data.weight) {
        weightSum.total += data.weight;
        weightSum.count++;
      }
      
      if (data.exercises && data.exercises.length > 0) {
        trainingDays++;
      }
      
      if (data.totalTime) {
        totalTime += data.totalTime;
      }
      
      if (data.totalCalories) {
        totalCalories += data.totalCalories;
      }
    }
  }
  
  // ç¾åœ¨ã®å¹³å‡è¡€åœ§ã‚’è¡¨ç¤º
  if (bpSum.count > 0) {
    const avgSys = Math.round(bpSum.systolic / bpSum.count);
    const avgDia = Math.round(bpSum.diastolic / bpSum.count);
    document.getElementById('current-bp-info').style.display = 'block';
    document.getElementById('current-bp-value').textContent = `${avgSys}/${avgDia} mmHg`;
  } else {
    document.getElementById('current-bp-info').style.display = 'none';
  }
  
  // ç¾åœ¨ã®å¹³å‡ä½“é‡ã‚’è¡¨ç¤º
  if (weightSum.count > 0) {
    const avgWeight = (weightSum.total / weightSum.count).toFixed(1);
    const profile = loadProfile();
    const bmi = profile && profile.height ? calculateBMI(avgWeight, profile.height) : null;
    document.getElementById('current-weight-info').style.display = 'block';
    document.getElementById('current-weight-value').textContent = 
      bmi ? `${avgWeight} kg (BMI: ${bmi})` : `${avgWeight} kg`;
  } else {
    document.getElementById('current-weight-info').style.display = 'none';
  }
  
  // ä»Šæœˆã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°å®Ÿç¸¾ã‚’è¡¨ç¤º
  if (trainingDays > 0 || totalTime > 0 || totalCalories > 0) {
    document.getElementById('current-training-info').style.display = 'block';
    document.getElementById('current-training-value').textContent = 
      `${trainingDays} æ—¥ / ${totalTime} åˆ† / ${totalCalories.toLocaleString()} kcal`;
  } else {
    document.getElementById('current-training-info').style.display = 'none';
  }
}

function loadSavedGoals() {
  const currentMonth = new Date().getMonth();
  const currentYear = new Date().getFullYear();
  const monthNames = ['january', 'february', 'march', 'april', 'may', 'june', 
                     'july', 'august', 'september', 'october', 'november', 'december'];
  const key = `${monthNames[currentMonth]}${currentYear}_goals`;
  
  const goalsStr = localStorage.getItem(key);
  if (goalsStr) {
    const data = JSON.parse(goalsStr);
    const goals = data.goals || data; // æ–°æ—§ä¸¡æ–¹ã®æ§‹é€ ã«å¯¾å¿œ
    
    if (goals.bloodPressure) {
      document.getElementById('goal-systolic').value = goals.bloodPressure.systolic || '';
      document.getElementById('goal-diastolic').value = goals.bloodPressure.diastolic || '';
    }
    
    if (goals.weight) {
      document.getElementById('goal-weight').value = goals.weight;
    }
    
    if (goals.trainingDays) {
      document.getElementById('goal-days').value = goals.trainingDays;
    }
    
    if (goals.totalTime) {
      document.getElementById('goal-time').value = goals.totalTime;
    }
    
    if (goals.totalCalories) {
      document.getElementById('goal-calories').value = goals.totalCalories;
    }
  } else {
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¨­å®š
    setDefaultGoals();
  }
}

function validateGoals() {
  clearGoalErrors();
  const errors = [];
  
  const profile = loadProfile();
  
  // è¡€åœ§ç›®æ¨™ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  const systolic = parseInt(document.getElementById('goal-systolic').value);
  const diastolic = parseInt(document.getElementById('goal-diastolic').value);
  
  if (systolic && (systolic < 100 || systolic > 139)) {
    errors.push({ 
      field: 'systolic', 
      message: 'åç¸®æœŸè¡€åœ§ã¯100-139 mmHgã§è¨­å®šã—ã¦ãã ã•ã„' 
    });
  }
  
  if (diastolic && (diastolic < 70 || diastolic > 89)) {
    errors.push({ 
      field: 'diastolic', 
      message: 'æ‹¡å¼µæœŸè¡€åœ§ã¯70-89 mmHgã§è¨­å®šã—ã¦ãã ã•ã„' 
    });
  }
  
  // ä½“é‡ç›®æ¨™ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  const goalWeight = parseFloat(document.getElementById('goal-weight').value);
  if (goalWeight && profile && profile.height) {
    const bmi = calculateBMI(goalWeight, profile.height);
    if (bmi < 18.5 || bmi > 30) {
      errors.push({ 
        field: 'goal-weight', 
        message: 'BMI 18.5-30ã®ç¯„å›²ã§è¨­å®šã—ã¦ãã ã•ã„ï¼ˆç¾åœ¨ã®BMI: ' + bmi + 'ï¼‰' 
      });
    }
  }
  
  // ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç›®æ¨™ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
  const days = parseInt(document.getElementById('goal-days').value);
  const time = parseInt(document.getElementById('goal-time').value);
  const calories = parseInt(document.getElementById('goal-calories').value);
  
  if (days && (days < 1 || days > 31)) {
    errors.push({ 
      field: 'days', 
      message: 'ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ—¥æ•°ã¯1-31æ—¥ã§è¨­å®šã—ã¦ãã ã•ã„' 
    });
  }
  
  if (time && (time < 30 || time > 3000)) {
    errors.push({ 
      field: 'time', 
      message: 'é‹å‹•æ™‚é–“ã¯30-3000åˆ†ã§è¨­å®šã—ã¦ãã ã•ã„' 
    });
  }
  
  if (calories && (calories < 100 || calories > 15000)) {
    errors.push({ 
      field: 'calories', 
      message: 'ã‚«ãƒ­ãƒªãƒ¼ã¯100-15000 kcalã§è¨­å®šã—ã¦ãã ã•ã„' 
    });
  }
  
  // ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
  errors.forEach(error => {
    const errorEl = document.getElementById(`error-${error.field}`);
    const inputEl = document.getElementById(`goal-${error.field}`);
    
    if (errorEl) {
      errorEl.classList.add('show');
      errorEl.textContent = error.message;
    }
    
    if (inputEl) {
      inputEl.classList.add('error');
    }
  });
  
  return errors.length === 0;
}

// ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã‚’ä¿å­˜
function saveCustomGoals() {
  if (!validateGoals()) {
    return;
  }
  
  const currentMonth = new Date().getMonth();
  const currentYear = new Date().getFullYear();
  const monthNames = ['january', 'february', 'march', 'april', 'may', 'june', 
                     'july', 'august', 'september', 'october', 'november', 'december'];
  const key = `${monthNames[currentMonth]}${currentYear}_goals`;
  
  const goals = {
    month: currentMonth,
    year: currentYear,
    setAt: new Date().toISOString(),
    type: 'custom',
    pattern: null,
    goals: {
      bloodPressure: {
        systolic: parseInt(document.getElementById('goal-systolic').value) || null,
        diastolic: parseInt(document.getElementById('goal-diastolic').value) || null
      },
      weight: parseFloat(document.getElementById('goal-weight').value) || null,
      trainingDays: parseInt(document.getElementById('goal-days').value) || null,
      totalTime: parseInt(document.getElementById('goal-time').value) || null,
      totalCalories: parseInt(document.getElementById('goal-calories').value) || null
    }
  };
  
  localStorage.setItem(key, JSON.stringify(goals));
  
  closeGoalModal();
  updateGoalDisplay();
  alert('âœ… æœˆé–“ç›®æ¨™ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
}

// æœˆé–“ç›®æ¨™è¡¨ç¤ºã®æ›´æ–°
function updateGoalDisplay() {
  const currentMonth = new Date().getMonth();
  const currentYear = new Date().getFullYear();
  const monthNames = ['january', 'february', 'march', 'april', 'may', 'june', 
                     'july', 'august', 'september', 'october', 'november', 'december'];
  const key = `${monthNames[currentMonth]}${currentYear}_goals`;
  
  const goalsStr = localStorage.getItem(key);
  
  if (goalsStr) {
    const data = JSON.parse(goalsStr);
    const goals = data.goals || data; // æ–°æ—§ä¸¡æ–¹ã®æ§‹é€ ã«å¯¾å¿œ
    
    // è¡€åœ§ç›®æ¨™
    if (goals.bloodPressure && goals.bloodPressure.systolic && goals.bloodPressure.diastolic) {
      document.getElementById('display-goal-bp').textContent = 
        `${goals.bloodPressure.systolic}/${goals.bloodPressure.diastolic} mmHg`;
    } else {
      document.getElementById('display-goal-bp').textContent = 'æœªè¨­å®š';
    }
    
    // ä½“é‡ç›®æ¨™
    if (goals.weight) {
      document.getElementById('display-goal-weight').textContent = `${goals.weight} kg`;
    } else {
      document.getElementById('display-goal-weight').textContent = 'æœªè¨­å®š';
    }
    
    // ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°æ—¥æ•°
    if (goals.trainingDays) {
      document.getElementById('display-goal-days').textContent = `${goals.trainingDays} æ—¥`;
    } else {
      document.getElementById('display-goal-days').textContent = 'æœªè¨­å®š';
    }
    
    // ç·é‹å‹•æ™‚é–“
    if (goals.totalTime) {
      document.getElementById('display-goal-time').textContent = `${goals.totalTime} åˆ†`;
    } else {
      document.getElementById('display-goal-time').textContent = 'æœªè¨­å®š';
    }
    
    // ç·æ¶ˆè²»ã‚«ãƒ­ãƒªãƒ¼
    if (goals.totalCalories) {
      document.getElementById('display-goal-calories').textContent = 
        `${goals.totalCalories.toLocaleString()} kcal`;
    } else {
      document.getElementById('display-goal-calories').textContent = 'æœªè¨­å®š';
    }
  } else {
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’è¡¨ç¤º
    document.getElementById('display-goal-bp').textContent = '120/80 mmHg';
    
    // ä½“é‡ã¯ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ã®BMI 22ã‹ã‚‰è¨ˆç®—
    const profile = loadProfile();
    if (profile && profile.height) {
      const targetBMI = 22;
      const heightM = profile.height / 100;
      const targetWeight = (targetBMI * heightM * heightM).toFixed(1);
      document.getElementById('display-goal-weight').textContent = `${targetWeight} kg`;
    } else {
      document.getElementById('display-goal-weight').textContent = '65.0 kg';
    }
    
    document.getElementById('display-goal-days').textContent = '12 æ—¥';
    document.getElementById('display-goal-time').textContent = '600 åˆ†';
    document.getElementById('display-goal-calories').textContent = '3,000 kcal';
  }
}

// åˆæœŸåŒ–
window.addEventListener('DOMContentLoaded', function() {
  // æœˆåˆ¥ãƒ†ãƒ¼ãƒã®é©ç”¨
  applyMonthTheme();
  
  const profile = loadProfile();
  
  if (profile) {
    // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç™»éŒ²æ¸ˆã¿
    document.getElementById('hero-cta').classList.remove('hidden');
    document.getElementById('profile-setup').classList.add('hidden');
    document.getElementById('profile-display').classList.remove('hidden');
    document.getElementById('goal-display').classList.remove('hidden');
    document.getElementById('main-navigation').classList.remove('hidden');
    
    updateProfileDisplay(profile);
    updateGoalDisplay();
  } else {
    // åˆå›è¨ªå•
    document.getElementById('hero-cta').classList.add('hidden');
    document.getElementById('profile-setup').classList.remove('hidden');
    document.getElementById('profile-display').classList.add('hidden');
    document.getElementById('goal-display').classList.add('hidden');
    document.getElementById('main-navigation').classList.add('hidden');
  }
});
</script>

</body>
</html>